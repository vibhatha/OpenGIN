"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[533],{2638(e,n,i){i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"overview/architecture/data_flow","title":"How It Works: End-to-End Data Flow","description":"This document describes the complete workflow of how data flows through the system, from initial JSON input to final storage in the databases.","source":"@site/docs/overview/architecture/data_flow.md","sourceDirName":"overview/architecture","slug":"/overview/architecture/data_flow","permalink":"/OpenGIN/docs/overview/architecture/data_flow","draft":false,"unlisted":false,"editUrl":"https://github.com/LDFLK/OpenGIN/tree/main/docs/docs/overview/architecture/data_flow.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"System Overview","permalink":"/OpenGIN/docs/overview/architecture/"},"next":{"title":"Service APIs","permalink":"/OpenGIN/docs/overview/architecture/api-layer-details"}}');var s=i(4848),r=i(8453);const a={},o="How It Works: End-to-End Data Flow",l={},d=[{value:"1. Data Entry Point (Ingestion API)",id:"1-data-entry-point-ingestion-api",level:2},{value:"Example JSON Input",id:"example-json-input",level:3},{value:"2. Data Transformation (Ingestion API \u2192 Core API)",id:"2-data-transformation-ingestion-api--core-api",level:2},{value:"2.1 JSON to Protobuf Conversion",id:"21-json-to-protobuf-conversion",level:3},{value:"Conversion Process Flowchart",id:"conversion-process-flowchart",level:4},{value:"Conversion Details",id:"conversion-details",level:4},{value:"2.2 gRPC Communication",id:"22-grpc-communication",level:3},{value:"3. Core API",id:"3-core-api",level:2},{value:"3.1 Create Entity Flow",id:"31-create-entity-flow",level:3},{value:"3.2 Data Storage",id:"32-data-storage",level:3},{value:"MongoDB Storage (Metadata)",id:"mongodb-storage-metadata",level:4},{value:"Neo4j Storage (Entity and Relationships)",id:"neo4j-storage-entity-and-relationships",level:4},{value:"4. Data Retrieval Flow (Read API)",id:"4-data-retrieval-flow-read-api",level:2},{value:"4.1 Read Entity Flow",id:"41-read-entity-flow",level:3},{value:"4.2 Data Transformation (Core API \u2192 Ingestion API)",id:"42-data-transformation-core-api--ingestion-api",level:3}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"how-it-works-end-to-end-data-flow",children:"How It Works: End-to-End Data Flow"})}),"\n",(0,s.jsx)(n.p,{children:"This document describes the complete workflow of how data flows through the system, from initial JSON input to final storage in the databases."}),"\n",(0,s.jsx)(n.h2,{id:"1-data-entry-point-ingestion-api",children:"1. Data Entry Point (Ingestion API)"}),"\n",(0,s.jsx)(n.p,{children:"The system receives data through a REST API built with Ballerina. The API accepts JSON payloads for entity creation and updates."}),"\n",(0,s.jsx)(n.h3,{id:"example-json-input",children:"Example JSON Input"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n    "id": "entity123",\n    "kind": {\n        "major": "Person",\n        "minor": "Employee"\n    },\n    "name": {\n        "startTime": "2024-01-01T00:00:00Z",\n        "endTime": "",\n        "value": "John Doe"\n    },\n    "metadata": {\n        "department": "Engineering",\n        "role": "Software Engineer"\n    },\n    "attributes": {\n        "expenses": {\n            "columns": ["type", "amount", "date", "category"],\n            "rows": [\n                ["Travel", 500, "2024-01-15", "Business"],\n                ["Meals", 120, "2024-01-16", "Entertainment"],\n                ["Equipment", 300, "2024-01-17", "Office"]\n            ]\n        }\n    },\n    "relationships": {\n        "reports_to": {\n            "relatedEntityId": "manager123",\n            "startTime": "2024-01-01T00:00:00Z",\n            "endTime": "",\n            "id": "rel123",\n            "name": "reports_to"\n        }\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"2-data-transformation-ingestion-api--core-api",children:"2. Data Transformation (Ingestion API \u2192 Core API)"}),"\n",(0,s.jsx)(n.h3,{id:"21-json-to-protobuf-conversion",children:"2.1 JSON to Protobuf Conversion"}),"\n",(0,s.jsxs)(n.p,{children:["The Ingestion API converts the JSON payload into a protobuf Entity message. This conversion happens in the ",(0,s.jsx)(n.code,{children:"convertJsonToEntity"})," function:"]}),"\n",(0,s.jsx)(n.h4,{id:"conversion-process-flowchart",children:"Conversion Process Flowchart"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"JSON to Protobuf Conversion Flow",src:i(4059).A+"",width:"1024",height:"1024"})}),"\n",(0,s.jsx)(n.h4,{id:"conversion-details",children:"Conversion Details"}),"\n",(0,s.jsx)(n.p,{children:"The conversion process involves several key transformations:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Metadata Processing"}),": Each metadata key-value pair is converted to a protobuf ",(0,s.jsx)(n.code,{children:"Any"})," type using ",(0,s.jsx)(n.code,{children:"pbAny:pack()"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Attributes Processing"}),": Each attribute is converted to a ",(0,s.jsx)(n.code,{children:"TimeBasedValueList"})," containing time-based values with ",(0,s.jsx)(n.code,{children:"startTime"}),", ",(0,s.jsx)(n.code,{children:"endTime"}),", and packed values"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Relationships Processing"}),": Each relationship is converted to a ",(0,s.jsx)(n.code,{children:"Relationship"})," object with all required fields"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Entity Assembly"}),": All processed components are combined into the final ",(0,s.jsx)(n.code,{children:"Entity"})," protobuf message"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The flowchart above shows the complete data transformation pipeline from JSON input to protobuf output."}),"\n",(0,s.jsx)(n.h3,{id:"22-grpc-communication",children:"2.2 gRPC Communication"}),"\n",(0,s.jsx)(n.p,{children:"The converted protobuf message is sent to the CORE service via gRPC. The communication happens on port 50051."}),"\n",(0,s.jsx)(n.h2,{id:"3-core-api",children:"3. Core API"}),"\n",(0,s.jsx)(n.p,{children:"The Core API receives the protobuf message and processes it through multiple steps:"}),"\n",(0,s.jsx)(n.h3,{id:"31-create-entity-flow",children:"3.1 Create Entity Flow"}),"\n",(0,s.jsx)(n.p,{children:"The Core API processes entity creation through a systematic three-step approach:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Step 1: Metadata Storage (MongoDB)"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The system first saves the entity's metadata to MongoDB"}),"\n",(0,s.jsxs)(n.li,{children:["This includes all key-value pairs from the ",(0,s.jsx)(n.code,{children:"metadata"})," field in the JSON payload"]}),"\n",(0,s.jsx)(n.li,{children:"MongoDB's flexible document structure allows for schema-less storage of metadata"}),"\n",(0,s.jsx)(n.li,{children:"The entity ID serves as the document identifier for quick retrieval"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Step 2: Entity Creation (Neo4j)"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The core entity information is stored in Neo4j as a graph node"}),"\n",(0,s.jsx)(n.li,{children:"This includes the entity ID, kind (major/minor), name, and timestamps"}),"\n",(0,s.jsx)(n.li,{children:"Neo4j's graph structure enables efficient relationship traversal and queries"}),"\n",(0,s.jsxs)(n.li,{children:["The entity becomes a node in the graph database with the ",(0,s.jsx)(n.code,{children:"Entity"})," label"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Step 3: Relationship Management (Neo4j)"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"All relationships defined in the JSON payload are created in Neo4j"}),"\n",(0,s.jsx)(n.li,{children:"Each relationship becomes a directed edge between entity nodes"}),"\n",(0,s.jsx)(n.li,{children:"Relationship properties include start/end times and relationship metadata"}),"\n",(0,s.jsx)(n.li,{children:"This enables complex graph queries and relationship traversal"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"32-data-storage",children:"3.2 Data Storage"}),"\n",(0,s.jsx)(n.h4,{id:"mongodb-storage-metadata",children:"MongoDB Storage (Metadata)"}),"\n",(0,s.jsx)(n.p,{children:"The metadata is stored in MongoDB as a document:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n    "_id": "entity123",\n    "metadata": {\n        "department": "Engineering",\n        "role": "Software Engineer"\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"neo4j-storage-entity-and-relationships",children:"Neo4j Storage (Entity and Relationships)"}),"\n",(0,s.jsx)(n.p,{children:"The entity and its relationships are stored in Neo4j using a graph-based approach:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Entity Node Creation"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Each entity becomes a node in the Neo4j graph with the ",(0,s.jsx)(n.code,{children:"Entity"})," label"]}),"\n",(0,s.jsxs)(n.li,{children:["The node contains core entity properties including:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Unique entity identifier (",(0,s.jsx)(n.code,{children:"id"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:["Entity classification (",(0,s.jsx)(n.code,{children:"kind_major"})," and ",(0,s.jsx)(n.code,{children:"kind_minor"}),")"]}),"\n",(0,s.jsx)(n.li,{children:"Entity name and display information"}),"\n",(0,s.jsxs)(n.li,{children:["Temporal information (",(0,s.jsx)(n.code,{children:"created"})," and ",(0,s.jsx)(n.code,{children:"terminated"})," timestamps)"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"This structure enables efficient entity lookup and management"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Relationship Creation"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Relationships between entities are represented as directed edges in the graph"}),"\n",(0,s.jsxs)(n.li,{children:["Each relationship has a specific type (e.g., ",(0,s.jsx)(n.code,{children:"REPORTS_TO"}),", ",(0,s.jsx)(n.code,{children:"MANAGES"}),", ",(0,s.jsx)(n.code,{children:"WORKS_FOR"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:["Relationship properties include:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Unique relationship identifier"}),"\n",(0,s.jsxs)(n.li,{children:["Temporal validity (",(0,s.jsx)(n.code,{children:"startTime"})," and ",(0,s.jsx)(n.code,{children:"endTime"}),")"]}),"\n",(0,s.jsx)(n.li,{children:"Additional relationship metadata"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"The directed nature allows for complex relationship traversal and queries"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Graph Query Capabilities"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The graph structure enables powerful relationship queries"}),"\n",(0,s.jsx)(n.li,{children:"Users can traverse relationships in any direction"}),"\n",(0,s.jsx)(n.li,{children:"Complex multi-hop queries are efficiently supported"}),"\n",(0,s.jsx)(n.li,{children:"Temporal queries can find relationships active at specific time periods"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"4-data-retrieval-flow-read-api",children:"4. Data Retrieval Flow (Read API)"}),"\n",(0,s.jsx)(n.h3,{id:"41-read-entity-flow",children:"4.1 Read Entity Flow"}),"\n",(0,s.jsx)(n.p,{children:"The Core API retrieves entity data through a systematic three-step aggregation process:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Step 1: Metadata Retrieval (MongoDB)"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The system first queries MongoDB to retrieve the entity's metadata"}),"\n",(0,s.jsx)(n.li,{children:"This includes all key-value pairs associated with the entity ID"}),"\n",(0,s.jsx)(n.li,{children:"MongoDB's document-based storage enables fast metadata lookup"}),"\n",(0,s.jsx)(n.li,{children:"The metadata provides additional context and properties for the entity"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Step 2: Entity Information Retrieval (Neo4j)"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Core entity information is fetched from Neo4j using the entity ID"}),"\n",(0,s.jsxs)(n.li,{children:["This includes fundamental entity properties such as:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Entity classification (kind major and minor)"}),"\n",(0,s.jsx)(n.li,{children:"Entity name and display information"}),"\n",(0,s.jsx)(n.li,{children:"Creation and termination timestamps"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Neo4j's graph structure enables efficient entity node lookup"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Step 3: Attribute Retrieval (PostgreSQL)"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Entity attributes are retrieved from PostgreSQL using the entity ID"}),"\n",(0,s.jsx)(n.li,{children:"This includes all time-based attribute values stored in dynamic tables"}),"\n",(0,s.jsxs)(n.li,{children:["Attribute data includes:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Attribute names and their corresponding values"}),"\n",(0,s.jsx)(n.li,{children:"Temporal information (start and end times for each value)"}),"\n",(0,s.jsx)(n.li,{children:"Data type information for proper value interpretation"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"PostgreSQL's relational structure enables efficient attribute querying and time-based filtering"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Step 4: Relationship Retrieval (Neo4j)"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"All relationships connected to the entity are retrieved from Neo4j"}),"\n",(0,s.jsx)(n.li,{children:"This includes both incoming and outgoing relationships"}),"\n",(0,s.jsxs)(n.li,{children:["Relationship data includes:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Related entity identifiers"}),"\n",(0,s.jsx)(n.li,{children:"Relationship types and properties"}),"\n",(0,s.jsx)(n.li,{children:"Temporal validity information"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"The graph structure enables efficient relationship traversal"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Data Aggregation and Response"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"All retrieved data is combined into a single entity response"}),"\n",(0,s.jsxs)(n.li,{children:["The system creates a comprehensive entity object containing:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Core entity information from Neo4j"}),"\n",(0,s.jsx)(n.li,{children:"Metadata from MongoDB"}),"\n",(0,s.jsx)(n.li,{children:"All time-based attributes from PostgreSQL"}),"\n",(0,s.jsx)(n.li,{children:"All associated relationships from Neo4j"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"The aggregated data is returned as a complete entity representation with full temporal support"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"42-data-transformation-core-api--ingestion-api",children:"4.2 Data Transformation (Core API \u2192 Ingestion API)"}),"\n",(0,s.jsx)(n.p,{children:"The retrieved data is converted back to JSON in the Ingestion API before being sent to the client."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},4059(e,n,i){i.d(n,{A:()=>t});const t=i.p+"assets/images/json_to_proto_flow-ad4cdffca7161673fff9c78a87014563.png"},8453(e,n,i){i.d(n,{R:()=>a,x:()=>o});var t=i(6540);const s={},r=t.createContext(s);function a(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);